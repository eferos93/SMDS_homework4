---
title: "SMDS_Homework4"
author: "Eros Fabrici, Arianna Tasciotti, Roberto Corti"
date: "5/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## DAAG

### Exercise 6
```{r DAAG - Exercise 6}
library(DAAG)
nihills <- hills2000

nihills.lm <- lm(time ~ dist+climb, data=nihills)
nihills2.lm <- lm(time ~ dist+climb+dist:climb, data=nihills)
anova(nihills.lm, nihills2.lm)
summary(nihills2.lm)
summary(nihills.lm)

```

```{r DAAG - Exercise 6}
plot(nihills2.lm)
```

From the Residual vs Fitted plot it is possble to notice that the variability is not constant while from the Q-Q plot two main outliers (Pentland and  12 Trig Trog).
Now, let's remove those two outliers and re-fit the models.
```{r DAAG - Exercise 6}
nihills_modified <- nihills[!(rownames(nihills)=="12 Trig Trog" | rownames(nihills)=="Pentland"),]
nihills_modified_lm <- lm(time ~ dist+climb, data=nihills_modified)
nihills_modified_lm2 <- lm(time ~ dist+climb+dist:climb, data=nihills_modified)
anova(nihills_modified_lm, nihills_modified_lm2)
summary(nihills_modified_lm2)
summary(nihills_modified_lm)
```
```{r DAAG - Exercise 6}
plot(nihills_modified_lm)
```
```{r DAAG - Exercise 6}
plot(nihills_modified_lm2)
```
Now it seems like that the linear model $time = \beta_0+\beta_1*dist+\beta_2*climb$ behaves better in therms of the $F$-statistic that the $time = \beta_0+\beta_1*dist+\beta_2*climb + \beta_3*dist*climb$ model. However, they both clearly show a lower variability than before according to the plots Residuals vs Fitted and scale location.






